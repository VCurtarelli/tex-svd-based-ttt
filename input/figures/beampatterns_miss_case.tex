%\pgfplotsset{
	%    table/myStyleWithMeta/.style={    
		%        meta=Label, 
		%    }
	%}
\def\ymin{-40}
\def\ymax{0}
\def\meshcols{32}
\def\meshrows{73}
%\definecolor{LightA}{HTML}{991F3D}
%\definecolor{LightC}{HTML}{997A1F}
%\definecolor{LightE}{HTML}{3D991F}
%\definecolor{LightB}{HTML}{1F997A}
%\definecolor{LightD}{HTML}{1F3D99}
%\definecolor{LightF}{HTML}{7A1F99}
%\definecolor{LightG}{HTML}{3F3F3F}

%\pgfplotsset{
	%    table/myStyleWithMeta/.style={    
		%        meta=Label, 
		%    }
	%}
\pgfplotsset{compat=1.17}
\begin{figure}[!t]
	\centering
	{\footnotesize
		\begin{subfigure}{0.8\linewidth}% resA
			\centering
			%\tikzsetnextfilename{beam_heatmap_resA}
			\begin{tikzpicture}
				\begin{heatmap}{\meshcols}[colorbar to name={beamHmA}]
					\addplot3[surf, mesh/cols=\meshcols, mesh/rows=\meshrows, shader=interp] table[x=ang, y=freq, z=val, col sep=comma] {figures/results/6x2 150ms 2cm miss/bp_id__mvdr_n.csv};
				\end{heatmap}
			\end{tikzpicture}
			\vspace*{-2mm}\caption{Oracle-NCM $\bvh{\mvdr}$}
			\label{subfig:beam_heatmap_mvdr_id_miss}
			\vspace*{2mm}
		\end{subfigure} \\%
		%
		\begin{subfigure}{0.8\linewidth}% resB
			\centering
			%\tikzsetnextfilename{beam_heatmap_resB}
			\begin{tikzpicture}
				\begin{heatmap}{\meshcols}[colorbar to name={beamHmB}]
					\addplot3[surf, mesh/cols=\meshcols, mesh/rows=\meshrows, shader=interp] table[x=ang, y=freq, z=val, col sep=comma] {figures/results/6x2 150ms 2cm miss/bp_es__mvdr_n.csv};
				\end{heatmap}
			\end{tikzpicture}
			\vspace*{-2mm}\caption{$\bvh{\mvdr}$}
			\label{subfig:beam_heatmap_mvdr_miss}
			\vspace*{2mm}
		\end{subfigure} \\%
		%
		\begin{subfigure}{0.8\linewidth}% resC
			\centering
			%\tikzsetnextfilename{beam_heatmap_resC}
			\begin{tikzpicture}
				\begin{heatmap}{\meshcols}[colorbar to name={beamHmC}]
					\addplot3[surf, mesh/cols=\meshcols, mesh/rows=\meshrows, shader=interp] table[x=ang, y=freq, z=val, col sep=comma] {figures/results/6x2 150ms 2cm miss/bp_es__lcmv_m.csv};
				\end{heatmap}
			\end{tikzpicture}
			\vspace*{-2mm}\caption{$\bvh{\lcmv}$}
			\label{subfig:beam_heatmap_lcmv_miss}
			\vspace*{2mm}
		\end{subfigure} \\%
		%
		\begin{subfigure}{0.8\linewidth}% resD
			\centering
			%\tikzsetnextfilename{beam_heatmap_resD}
			\begin{tikzpicture}
				\begin{heatmap}{\meshcols}[colorbar to name={beamHmD}]
					\addplot3[surf, mesh/cols=\meshcols, mesh/rows=\meshrows, shader=interp] table[x=ang, y=freq, z=val, col sep=comma] {figures/results/6x2 150ms 2cm miss/bp_es__rcmg_m.csv};
				\end{heatmap}
			\end{tikzpicture}
			\vspace*{-2mm}\caption{$\bvh{\rcmg}$}
			\label{subfig:beam_heatmap_rcmg_miss}
			\vspace*{2mm}
		\end{subfigure} \\%
	}
	
	%\tikzsetnextfilename{beam_heatmap_colormap}
	\ppref{beamHmD}
	\caption{Beampatterns for the miss-steered case.}
	\label{fig:beam_heatmap_case_miss}
\end{figure}