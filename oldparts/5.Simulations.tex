%\section{Simulations and tests}
%
%\subsection{First battery - Basic simulation}
%
%In this simulation, we have a highly controlled environment: no signals are used, only steering vectors and correlation matrices. All sources are far-field. We define $\Corr{\bvy}$ as
%\begin{equation}
%	\Corr{\bvy} = \bva \he{\bva} \var{x_1} + \bvb \he{\bvb} \var{u_1} + \Corr{\bvga}' \var{\gamma_1} + \Corr{\bvv}' \var{v} + \bv{M} \var{m}
%\end{equation}
%where $\bv{M}$ is an $\sz{M}{M}$ matrix where each entry is a sample of a Gaussian unitary normal distribution, to simulate error and imprecision in the estimations. All other matrices are assumed known (form the array geometry), and that they correctly model the system.
%
%The array is comprised of $12$ sensors, with an inter-sensor distance of $5\si{\centi\meter}$, in three geometries: a linear array; a rectangular array with $4\times3$ sensors ($\x\text{-}\y$ plane); or a cubic array with $3\times2\times2$ sensors.
%
%For all, the simulation step taken was $\alpha = 1e-2$, and the derivative threshold was $1e-5$.
%
%\subsubsection{First simulation}
%
%This simulation is a sanity check. We have $\var{x_1} = 1$, $\var{u_1} = 0.5$, $\var{\gamma_1} = 0.3$, $\var{v_1} = 0.01$ and $\var{m} = 0$. The desired signal is at $\Theta_{x} = (0\dg,0\dg)$, and the undesired at $\Theta_{u} = (60\dg, 15\dg)$. We assume we know $\Theta_{u}$, and want to test only estimation of $\bvsi[h]$. This simulation was a success, as for all three arrays $\bvsi[h] = \bvsi$.
%
%\subsubsection{Second simulation}
%
%Now we will test the iterative method for calculating the angles. The initial guess is $\Theta_{u;0} = (20\dg, 45\dg)$.
%
%The linear array converged to a solution $\Theta_{u}\opt = (24.32\dg, 57.99\dg)$. Although this is notably different, they are identical under the cylindrical symmetry of the ULA, such that their aperture is the same.
%
%The rectangular array converged to a solution $\Theta_{u}\opt = (59.99\dg, 15\dg)$, practically identical to the real value. The cubic array reached the same solution. Both also took considerably longer than the ULA to converge to the correct angle.
%
%The ULA took 23 iterations to converge, the URA took 4051 iterations, and the UCA took 5973 iterations.
%
%If we increase $\alpha$ to $1e-1$, the URA takes 401 iterations, the UCA takes 594, and the ULA doesn't converge, as the step is too big. 
%
%Increasing the threshold to $1e-4$ also has an effect on the number of iterations, but not as significant as increasing $\alpha$.
%
%We also tested for two different initial guesses: one being $\Theta_{u;0} = (-20\dg,45\dg)$, and the other $\Theta_{u;0} = (20\dg,-45\dg)$. In both cases, the ULA converged to the same solution as before, but with the respective angle being negative in each guess (as all of them lay on the same aperture angle). The URA and UCA converged to the correct angles ($(59.99\dg, 15.02\dg)$ and $(59.99\dg,15.04\dg)$ respectively)), in less iterations than previously.
%
%\subsubsection{Third simulation}
%
%In this simulation, we add a small imperfection to the SCM, by increasing the value of $\var{m}$. We tested for values of $\var{m}$ from $10^{-4}$ up to $10$, and for each we did the iterative process to achieve the best angle. Trivially, as $\var{m}$ increases so does the error in the angles, however generally 
%
%For all arrays, the results are in the figures below, showing the number of steps, and the final azimuth and elevation angles.
%
%\begin{figure}[H]
%	\input{figures/plot_theta.tex}
%\end{figure}
%
%\begin{figure}[H]
%	\input{figures/plot_phi.tex}
%\end{figure}
%
%\begin{figure}[H]
%	\input{figures/plot_apperture.tex}
%\end{figure}
%
%We see that the ULA results (in red) are more robust than with the URA and UCA arrangements, likely being a byproduct of the cylindrical symmetry for this array, this excess of desirable minimum points resulting in a more robust set of minimums after the corruption with the undesired matrix.
%
%\subsection{Second battery - With RIR's}
%
%In this situation, we are using room impulse responses generated through Habets' RIR generator to simulate the environment.
%
%\subsubsection{First simulation}
%
%Again, this is a sanity check. In this we set the room's reverberation time to 0, and with only two sources; this is such that the diffuse noise is completely null, which is a simpler case to test. The room's size is $(10\m,~10\m,~3\m)$, with the sensor array located around $(3\m,~1\m,~1\m)$. The desired source is at $(9\m,~1\m,~1\m)$, and the undesired at ($5\m,~10\m,~2.8\m)$ (or, a direction of approx. $\Theta = (78\dg,12\dg)$ w.r.t. the sensor array). There's also diffuse noise simulated using 8 circularly-spaced sources around the array's center, 3 meters away from it.
%
%%We tested uniform linear and rectangular arrays; both converged to the desired direction (the ULA converging to a symmetry), within an acceptable error of $5\dg$. The ULA's convergence rate was much greater than that of the URA, due to its cylindrical symmetry; and also the angular distance was closer for the ULA than for the URA, even with the URA taking 50x more iterations to achieve convergence.
%In the next two cases, we used 64 samples windows, and tested on the 10th bin.
%
%With the ULA, when the desired signal's variance is lower than the undesired source's, it gets mixed up with the diffuse noise, and the result is a null variance on the desired signal's direction. Still, in these cases the error between $\Corr{\bvy}$ and $\Corr*{\bvy}$ was low, of about $10\%$, and the angle error was small (between $1\dg$ and $5\dg$). Also, for some frequencies a multi-initialization process was necessary, otherwise the angle would converge to a false (and wrong) minimum.
%
%With the URA, the iterative angle process took much longer, sometimes converging to a wrong direction even when initialized in the right direction, and led to larger errors between estimate and correct SCM's (between $20\%$ and $60\%$), and larger directional errors (between $10\dg$ and $20\dg$).
%
%In this scenario, we expanded to testing over the whole frequency range. Taking the average over the spectrum, the angle error was small (less than $1\dg$) for the ULA, and as well (around $1\dg$) for the URA. On average as well, the ULA took 220 iterations to complete, while the URA took 960 iterations.
%
%\subsection{Signal enhancement simulations}
%
%Having achieved acceptable errors on the direction of arrival estimation, we designed three beamformers based on the estimated information: MVDR, LCMV, and RCMG (regionally constrained maximum gain) beamformers. We set the MVDR beamformer as the baseline for performance, comparing the other two to it.
%
%\textbf{Many} scenarios were tested, most with comparable results between the LCMV and RCMG (with the RCMG being slightly behind in terms of noise reduction).