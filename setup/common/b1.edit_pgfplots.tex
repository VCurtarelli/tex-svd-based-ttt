%% Requires:
% PGFPlots

%BEGIN_FOLD
\usepgfplotslibrary{external}
\usepgfplotslibrary{polar}
\newlength{\Yaxisshift}
\setlength{\Yaxisshift}{3.8cm}

%\usetikzlibrary{external}
%\tikzexternalize
%\tikzsetexternalprefix{figures/tikz_ext/}

\NewDocumentEnvironment{polar}{}{
	\begin{polaraxis}[
		%BEGIN_FOLD
		xtick = {
			0,
			30,
			60,
			90,
			120,
			150,
			180,
			210,
			240,
			270,
			300,
			330
		},
		xticklabels = {
			$0\dg$,
			$30\dg$,
			$60\dg$,
			$90\dg$,
			$120\dg$,
			$150\dg$,
			$\PM180\dg$,
			$-150\dg$,
			$-120\dg$,
			$-90\dg$,
			$-60\dg$,
			$-30\dg$
		},
		ymax=0, ymin=\ymin,
		rotate=-90,
		width=0.75\linewidth,
		height=0.75\linewidth,
		x dir=reverse,
		xticklabel style={anchor=-\tick-90},
		y coord trafo/.code=\pgfmathparse{##1-\ymin},
		y coord inv trafo/.code=\pgfmathparse{##1\ymin},
		yticklabel={$\pgfmathprintnumber{\tick}\dB$},
		yticklabel style={anchor=west, xshift=\Yaxisshift+1ex},
		y axis line style={yshift=\Yaxisshift},
		ytick style={yshift=\Yaxisshift},
		ytick align=outside,
		ytick = {0, -20, ..., \ymin},
		ylabel={$\abs{\beam}$ (dB)},
		ylabel style={xshift=\Yaxisshift, yshift=0.16\linewidth},
		%END_FOLD
	]
}{
	\end{polaraxis}
}
%END_FOLD

%BEGIN_FOLD
\usepgfplotslibrary{colorbrewer}
\NewDocumentEnvironment{heatmap}{m O{} O{}}{
	\begin{axis}[
		colormap/viridis,
		colorbar horizontal,
		colorbar style={
			colormap/viridis,
			width=0.75\linewidth,
			height=12pt,
			%			xlabel = Beampattern,
			xtick = {0.5*(\ymin+\ymax)},
			xticklabel style={
				/pgf/number format/.cd,
				fixed,
				%title=,
				precision=0,
				fixed zerofill,
				%				opacity=1
			},
			tick label style={opacity=1},
			major tick length=4pt,
			xtick style={black},
			xtick pos=top,
			extra x ticks = {\ymin,\ymax},
			extra x tick style = {major x tick style={draw=none}},
			point meta min=\ymin,
			point meta max=\ymax,
			#3
		},
		width=0.9\linewidth,
		height=0.9\linewidth,
		point meta min=\ymin,
		point meta max=\ymax,
		mesh/cols=#1,
		xlabel style = {anchor=north, yshift=0.9\linewidth-1.5em},
		view={0}{90},
		grid style = {draw=none},
		ylabel style={anchor=center, yshift=-0.9\linewidth+1.5em},
		ytick={0, 500, ..., 2500},
		yticklabels={0, 0.5, ..., 2.5},
		xtick={0, 1000, 2000, 3000},
		xticklabels={0, 1, 2, 3},
		xmin=0, xmax=3000,
		ymin=0, ymax=2500,
		xlabel={Offset ($\si{\kilo\meter}$)},
		ylabel={Depth ($\si{\kilo\meter}$)},
		major tick length=2pt,
		ytick style = {black},
		ytick pos = left,
		mesh/ordering=x varies,
		y dir=reverse,
		#2
		]
		\centering
	}{
	\end{axis}
}
%END_FOLD

\newlength{\wdtwenty}
\setlength{\wdtwenty}{\widthof{$-20$}}
%\setlength{\wdtwenty}{\widthof{-20}}
\pgfplotsset{
    every colorbar global/.append style={
        zmin=,zmax=,
    }
}

%BEGIN_FOLD
\NewDocumentEnvironment{lineplot}{O{axis} m m O{}}{ % xlabel | ylabel | other arguments
	\begin{#1}[
		width=0.9\linewidth,
		height=0.7\linewidth,
		%
		%		xtick = {1, 2 ,..., 7},
		xtick align=outside,
		xtick pos=bottom,
		ytick align=outside,
        ytick pos=right,
		%
		xlabel = #2,
		ylabel = #3,
%		yticklabel style={text width=\wdtwenty, align=right},
		ylabel style={yshift=-2em},
		% xlabel style={yshift=0.5em},
		%
		%
		%		legend pos={outer south},
		%
		legend cell align={left},
		legend style={
			fill=white,
			%			fill opacity=0.5.6,
			draw opacity=1,
			text opacity=1,
			%			at={(1.05, 0.5)},
			%			anchor=west,
			legend columns=2,
			/tikz/every even column/.append style={column sep=1em}
		},
        xmin=0.5, xmax=50.5,
        yticklabel pos=right,
        xtick={1, 10, 20, 30, 40, 50},
        yticklabel style={
            text width=2em,
            anchor=west,
            align=left,
            % xshift=-0.2em,
            },
		#4,
		]
%		\draw[thin, dash pattern = {on 4pt off 1pt}] (axis cs:\pgfkeysvalueof{/pgfplots/xmin},0) -- (axis cs:\pgfkeysvalueof{/pgfplots/xmax},0);
	}{
	\end{#1}
}
%END_FOLD

%BEGIN_FOLD
\tikzstyle{axis} = [
	black
]
\tikzstyle{resA} = [
	thick, ColA, dash pattern = {on 1pt off 0pt},
	mark=square*, mark size=2, mark options={
		rotate=0,
		solid,
        opacity=0.5,
        fill opacity=0.5
	}
]
\tikzstyle{resB} = [
	thick, ColB, dash pattern = {on 1pt off 1pt},
	mark=triangle*, mark size=3, mark options={
		rotate=0,
		solid,
        opacity=0.5,
        fill opacity=0.5
	}
]
\tikzstyle{resC} = [
	thick, ColC, dash pattern = {on 4pt off 2pt},
	mark=star, mark size=3, mark options={
		rotate=0,
		solid,
		very thick,
        opacity=0.5,
        fill opacity=0.5
	}
]
\tikzstyle{resD} = [
	thick, ColD, dash pattern = {on 4pt off 2pt on 1pt off 2pt},
	mark=square*, mark size=2, mark options={
		rotate=45,
		solid,
        opacity=0.5,
        fill opacity=0.5
	}
]
\tikzstyle{resE} = [
	thick, ColE, dash pattern = {on 3pt off 1pt},
	mark=triangle*, mark size=1.5, mark options={
		rotate=180,
		solid,
	}
]
\tikzstyle{resF} = [
	thick, ColF, dash pattern = {on 3pt off 2pt},
	mark=x, mark size=2, mark options={
		rotate=0,
		solid,
		very thick
	}
]
\tikzstyle{resG} = [
	thick, ColG, dash pattern = {on 3pt off 4pt},
	mark=+, mark size=2, mark options={
		rotate=0,
		solid,
		very thick
	}
]
%END_FOLD